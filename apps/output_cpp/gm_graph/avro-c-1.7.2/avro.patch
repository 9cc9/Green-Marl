Common subdirectories: vanilla/avro-c-1.7.2/src//avro and src//avro
diff -u vanilla/avro-c-1.7.2/src//datafile.c src//datafile.c
--- vanilla/avro-c-1.7.2/src//datafile.c	2012-09-17 17:36:46.000000000 -0700
+++ src//datafile.c	2012-11-03 15:55:56.861359349 -0700
@@ -275,11 +275,7 @@
 	avro_schema_decref(meta_schema);
 
 	rval = avro_value_get_by_name(&meta, "avro.codec", &codec_val, NULL);
-	if (rval) {
-		avro_set_error("File header doesn't contain a codec");
-		avro_value_decref(&meta);
-		return rval;
-	} else {
+	if (!rval) {
 		const void *buf;
 		size_t size;
 		char codec_name[11];
Only in src/: datafile.c~
diff -u vanilla/avro-c-1.7.2/src//generic.c src//generic.c
--- vanilla/avro-c-1.7.2/src//generic.c	2012-09-17 17:36:46.000000000 -0700
+++ src//generic.c	2012-11-03 15:49:21.361353956 -0700
@@ -2653,7 +2653,7 @@
 	const avro_generic_map_t  *self = (const avro_generic_map_t *) vself;
 	child->iface = &iface->child_giface->parent;
 	child->self = avro_raw_map_get(&self->map, name, index);
-	return 0;
+	return (child->self == NULL ? EINVAL : 0);
 }
 
 static int
Only in src/: generic.c~
